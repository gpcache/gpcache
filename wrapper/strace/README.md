It would be stupid to reinvent the wheel, however strace doesn't have a pretty API for reuse.
So some files are copied here to be included directly.
Some code is copy pasted, because the entire file uses too much macro magic etc.
